# ğŸ¯ Admin Guide: How to Use Edit Offer & Auto-Relist

## Step-by-Step Instructions for Admins

### 1ï¸âƒ£ Access Partner's Offers
1. Open Admin Dashboard
2. Click on **"Partners"** tab
3. Find the partner you want to manage
4. Click the **eye icon (ğŸ‘ï¸)** to view their offers

### 2ï¸âƒ£ Edit an Offer
You'll see a table with all partner's offers. For each offer, there are now **4 action buttons**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Title         â”‚ Category â”‚ Price â”‚ Qty â”‚ Status â”‚ Actions â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Fresh Bread   â”‚ BAKERY   â”‚ $3.50 â”‚ 20  â”‚ Active â”‚  ğŸ“ â–¶ â¸ ğŸ—‘ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                    â†‘
                                                    NEW!
```

**Action Buttons:**
- ğŸ“ **Edit** (blue) - Edit offer details and enable auto-relist
- â–¶ï¸ **Resume** (green) - Resume paused offer
- â¸ï¸ **Pause** (orange) - Pause active offer  
- ğŸ—‘ï¸ **Delete** (red) - Delete offer permanently

### 3ï¸âƒ£ Edit Offer Details

Click the **ğŸ“ Edit** button to open the edit dialog:

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    Edit Offer                         â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                       â•‘
â•‘  Title                                                â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ Fresh Artisan Bread                             â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                       â•‘
â•‘  Description                                          â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ Baked fresh daily with organic ingredients      â”‚ â•‘
â•‘  â”‚                                                  â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                       â•‘
â•‘  Price ($)              Quantity                      â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ 3.50            â”‚   â”‚ 20                       â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                       â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ ğŸ”„ Auto-Relist Daily                    [  ON] â”‚ â•‘
â•‘  â”‚                                                 â”‚ â•‘
â•‘  â”‚ Automatically relist this offer every day      â”‚ â•‘
â•‘  â”‚ when business opens until closing time         â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                       â•‘
â•‘           [ Cancel ]      [ Save Changes ]            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 4ï¸âƒ£ Enable Auto-Relist

**What is Auto-Relist?**
When enabled, the system will automatically "refresh" this offer every day during the partner's business hours. This keeps the offer visible and fresh in the marketplace.

**To Enable:**
1. In the Edit Offer dialog, find the **"Auto-Relist Daily"** section
2. Toggle the switch to **ON** (blue)
3. Click **"Save Changes"**

**What Happens Next:**
- Every day when the business opens, the offer gets automatically relisted
- The offer appears fresh and new to customers
- No manual work required from partner or admin
- Works only during business hours (respects open/close times)

### 5ï¸âƒ£ Example Use Cases

#### ğŸ¥ Bakery - Daily Fresh Items
```
Offer: "Yesterday's Pastries - $2"
Auto-Relist: ON
Business Hours: 6:00 AM - 8:00 PM

Result: 
- 6:00 AM: Offer automatically relisted
- Customers see fresh listing
- Repeats every day
```

#### ğŸ• Restaurant - Lunch Specials
```
Offer: "Lunch Special - Pizza Slice"
Auto-Relist: ON
Business Hours: 11:00 AM - 10:00 PM

Result:
- 11:00 AM: Offer appears fresh
- Available throughout business day
- Next day: Automatically relisted at 11:00 AM
```

#### ğŸª 24-Hour Store
```
Offer: "Night Snacks Deal"
Auto-Relist: ON
Business Hours: 24 Hours

Result:
- Relisted at any time during the day
- Always stays fresh
```

## ğŸ“‹ Setup Requirements (One-Time)

Before auto-relist works, you need to:

### âœ… Step 1: Run Database Migration
1. Go to Supabase Dashboard
2. Navigate to SQL Editor
3. Copy content from: `supabase/migrations/20251117_add_auto_relist_feature.sql`
4. Paste and run

### âœ… Step 2: Deploy Edge Function
Run in terminal:
```bash
deploy-auto-relist.bat
```

Or manually:
```bash
supabase functions deploy auto-relist-offers
```

### âœ… Step 3: Set Up Cron Job
In Supabase SQL Editor, run:

```sql
-- Run every hour to check and relist offers
SELECT cron.schedule(
  'auto-relist-offers-hourly',
  '0 * * * *',
  $$
  SELECT net.http_post(
    url := 'https://your-project-ref.supabase.co/functions/v1/auto-relist-offers',
    headers := jsonb_build_object(
      'Content-Type', 'application/json',
      'Authorization', 'Bearer ' || current_setting('app.settings.service_role_key')
    ),
    body := '{}'::jsonb
  )
  $$
);
```

**Replace** `your-project-ref` with your actual Supabase project reference.

## â“ FAQ

**Q: What if I disable auto-relist?**  
A: Simply edit the offer and toggle it OFF. The offer will stop relisting automatically.

**Q: Can I edit other fields too?**  
A: Yes! You can edit title, description, price, quantity, and auto-relist all at once.

**Q: What happens if business is closed?**  
A: The system checks business hours. It only relists during open hours.

**Q: Will it create duplicate listings?**  
A: No, the system tracks the last relist date and prevents duplicates.

**Q: Can I see when an offer was last relisted?**  
A: Check the `last_relisted_at` column in the offers table in Supabase.

## ğŸ‰ Benefits

âœ… **Time Saver** - No daily manual relisting needed  
âœ… **Consistent** - Offers always appear fresh  
âœ… **Automated** - Works 24/7 without intervention  
âœ… **Smart** - Respects business hours  
âœ… **Flexible** - Enable/disable per offer  

---

**Need Help?** Check `AUTO_RELIST_SETUP_GUIDE.md` for technical details.
